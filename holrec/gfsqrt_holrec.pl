#!perl

# Convert generating functions with 1/sqrt(1 - c1*x - c2*x^2 ... - ck*x^k) 
# and generate calls to HolonomicRecurrence
# @(#) $Id$
# 2019-01-01, Georg Fischer
# Cf. <https://cs.uwaterloo.ca/journals/JIS/VOL9/Noe/noe35.pdf>, Eq. 4
# <http://www.teherba.org/index.php?title=OEIS/Square_Root_Recurrences>
#
#:# Usage:
#:#   perl gfsqrt_holrec.pl gfsqrt2.tmp > outfile
#
# - keep so many initial terms as necessary for the order
# - compute the recurrence formula
# - generate the call for HolonomicRecurrence
#---------------------------------
use strict;
use integer;
use warnings;

my $aseqno;
my $matrix;
my $line;

while(<>) {
    s{\s+\Z}{}; # chompr
    $line = $_;
    my ($aseqno, $callcode, $offset1, $coeff, $offset2, $initerms, @rest) = split(/\t/, $line);
    my @coeffs = split(/\,\s*/, $coeff);
    my $order = scalar(@coeffs) - 1;
    my @inits  = split(/\,\s*/, $initerms);
    # A101106   1, 3, 12, 57, 283, 1440, 7461, 39159, 207492, 1107549, 5946543, 32080032
    # A101106   gfsqrt  0   1,-6,3,-6,1        1,3,12,57,283,1440
    # 1/sqrt(1                - 6*x              - (-3)*x^2            - 6*x^3            - (-1)*x^4)
    #   0 =  1*(2*n-0)*a(n-0) - 6*(2*n-1)*a(n-1) - (-3)*(2*n-2)*a(n-2) - 6*(2*n-3)*a(n-3) - (-1)*(2n-4)*a(n-4)
    my $matrix = "[[0]";
    my $ind = $order;
    map { my $coe = $_;
        my $result = ($coe * $ind) . "," . ($coe * (-2)); # 2*n
        $matrix .= ",[$result]";
        $ind --;
    } reverse(@coeffs);
    $matrix .= "]";
    print join("\t", $aseqno, "holos", $offset1 
        , $matrix
        , "[" . join(",", splice(@inits, 0, $order)) . "]"
        , 0, $offset2, "gfis", $coeff) . "\n";  
} # while <>

__DATA__
A028329 gfsqrt  0   1,-4    2,4,12,40,140,504,1848,6864,25740,97240,369512,1410864,5408312,20801200,80233200,310235040,1202160780,4667212440,18150270600,70690527600,275693057640,1076515748880,4208197927440,16466861455200    24
A051286 gfsqrt  0   1,-2,-1,-2,1    1,1,2,5,11,26,63,153,376,931,2317,5794,14545,36631,92512,234205,594169,1510192,3844787,9802895,25027296,63972861,163701327,419316330,1075049011,2758543201,7083830648,18204064403,46812088751,120452857976  30
A059345 gfsqrt  0   1,-2,-5,2,1 1,1,4,9,29,82,255,773,2410,7499,23575,74298,235325,747407,2381126,7603433,24332595,78013192,250540055,805803691,2595158718,8368026845,27012184877,87283372610,282294378071,913775677281,2960160734818   27
A084768 gfsqrt  0   1,-14,1 1,7,73,847,10321,129367,1651609,21360031,278905249,3668760487,48543499753,645382441711,8614382884849,115367108888311,1549456900170553,20861640747345727,281483386791966529,3805228005705102151,51527535767904810889,698796718936034430607   20
A084769 gfsqrt  0   1,-18,1 1,9,121,1809,28401,458649,7544041,125700129,2114588641,35836273449,610897146201,10463745263409,179939616743121,3104680678772409,53721299280288201,931852905510160449,16198821321758152641   17


A081207
G.f.: (1+x)/sqrt(1-2x-x^2-2x^3+x^4) - Paul Barry, Jun 04 2005
Conjecture: n*(n-2)*a(n) +(-2*n^2+5*n-1)*a(n-1) +(-n^2+3*n-4)*a(n-2) +(-2*n^2+7*n-4)*a(n-3) +(n-1)*(n-3)*a(n-4)=0. - R. J. Mathar, Nov 12 2012

A101106     1, 3, 12, 57, 283, 1440, 7461, 39159, 207492, 1107549, 5946543, 32080032
G.f.: 1/sqrt(1-6x+3x^2-6x^3+x^4); a(n)=sum{k=0..n, binomial(n-k, k)(-1)^k*A001850(n-2k)}.
Conjecture: n*a(n) +3*(-2*n+1)*a(n-1) +3*(n-1)*a(n-2) +3*(-2*n+3)*a(n-3) +(n-2)*a(n-4)=0.
1/sqrt(1- 6*x              - (-3)*x^2            - 6*x^3            - (-1)*x^4)
2n*a(n) = 6*(2*n-1)*a(n-1) + (-3)*(2*n-2)*a(n-2) + 6*(2*n-3)*a(n-3) + (-1)*(2n-4)*a(n-4).

A118650
G.f.: (1-x)/sqrt(1-8*x+12*x^2-4*x^3)  - Mark van Hoeij, Apr 16 2013
Conjecture: n*a(n) +3*(-3*n+2)*a(n-1) +4*(5*n-8)*a(n-2) +2*(-8*n+21)*a(n-3) +2*(2*n-7)*a(n-4)=0. - R. J. Mathar, Nov 10 2013
... Proof ...

A132310 1, 5, 21, 83, 319, 1209, 4551, 17085, 64125, 240995, 907741, 3428655, 12990121
G.f.: A(x) = 1/sqrt(1 - 10*x + 33*x^2 - 36*x^3).
Recurrence: n*a(n) = (7*n-2)*a(n-1) - 6*(2*n-1)*a(n-2) . - Vaclav Kotesovec, Oct 20 2012
??? only a(n-2) ??? ok up to 300, decrease order of g.f.?
1/sqrt(1 - 10*x - (-33)*x^2 - 36*x^3)
RecurrenceTable[{a[0]==1,a[1]==5,a[2]==21, 2*n*a[n] == 10*(2*n-1)*a[n-1] + (-33)*(2n-2)*a[n-2] + (36)*(2*n-3)*a[n-3]},a,{n,0,10}]


A191649 1, 3, 14, 71, 379, 2082, 11651, 66051, 378064, 2180037, 12644861, 73695358
G.f.: 1/sqrt(x^4 +2*x^3 -x^2 -6*x +1). - Mark van Hoeij, Apr 17 2013
Conjecture: n*a(n) +3*(-2*n+1)*a(n-1) +(-n+1)*a(n-2) +(2*n-3)*a(n-3) +(n-2)*a(n-4)=0. - R. J. Mathar, Oct 08 2016
RecurrenceTable[{a[0]==1,a[1]==3,a[2]==14,a[3]==71, 
  0==n*a[n]+ 3*(-2*n+1)*a[n-1] +(-n+1)*a[n-2]+(2*n-3)*a[n-3]+(n-2)*a[n-4]},a,{n,0,1000}] ok

n*a[n] == (6*n-3)*a[n-1] +(n-1)*a[n-2] -(2*n-3)*a[n-3] -(n-2)*a[n-4]
1/sqrt(1           - 6*x              - 1*x^2           - (-2)*x^3            - (-1)*x^4)
  (2*n - 0)*a[n-0] - 6*(2*n-1)*a[n-1] - 1*(2n-2)*a[n-2] - (-2)*(2*n-3)*a[n-3] - (-1)*(2*n-4)*a[n-4]} ,a,{n,0,10}]

RecurrenceTable[{a[0]==1,a[1]==3,a[2]==14,a[3]==71,
