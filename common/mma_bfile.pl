#!perl

# Convert Mathematica Print output to b-file
# @(#) $Id$
# 2019-02-18, Georg Fischer
#
# usage:
#   perl mma_bfile.pl -o offset -s seqno input > output.txt
#       -o offset (index of first term)
#       -s sequence number [Ab]nnnnnn
#---------------------------------
use strict;
use integer;
use POSIX;

my ($sec, $min, $hour, $mday, $mon, $year, $wday, $yday, $isdst) = localtime (time);
my $timestamp = sprintf ("%04d-%02d-%02dT%02d:%02d:%02d\+01:00"
        , $year + 1900, $mon + 1, $mday, $hour, $min, $sec, $isdst);
my @parts = split(/\s+/, POSIX::asctime($sec, $min, $hour, $mday, $mon, $year, $wday, $yday, $isdst));
#  "Fri Jun  2 18:22:13 2000\n\0"
#  0   1    2 3        4
my $sigtime = sprintf("%s %02d %04d", $parts[1], $parts[2], $parts[4]);

my $basedir   = "../coincidence/database";
my $names     = "$basedir/names";     

my $offset = 1;
my $seqno6 = "999999";
while (scalar(@ARGV) > 0 and ($ARGV[0] =~ m{\A\-})) {
    my $opt = shift(@ARGV);
    if (0) {
    } elsif ($opt  =~ m{o}) {
        $offset    =  shift(@ARGV);
    } elsif ($opt  =~ m{s}) {
        my $seqno  =  shift(@ARGV);
        $seqno =~ s{\D}{}g;
        $seqno6 = sprintf("%06d", $seqno); 
    } else {
        die "invalid option \"$opt\"\n";
    }
} # while $opt
# get the name
my $name = `grep -E \"^A$seqno6\" $names`;
$name =~ s{\s+}{ }g;

undef $/; # slurp mode
my $buffer = <>;
$buffer =~ s{[^\,\-0-9]}{}g;
my @terms = split(/\,/, $buffer);
my $bfimin = $offset;
my $bfimax = $offset + scalar(@terms) - 1;
my $ind = $offset;
print <<"GFis";
# $name
# Table of n, a(n) for n = $bfimin..$bfimax
# Formatted with mma_bfile.pl by Georg Fischer, $sigtime.
GFis
foreach my $term(@terms) {
	print "$ind $term\n";
	$ind ++;
}
print "\n"; # for Alois
__DATA__
{1, 1, 2, 6, 22, 100, 518, 3122, 20676, 154524, 1238952, 11030448, 103376832, 1068000024, 11407673496, 134352996744, 1603035004368, 21276244952784, 278535036773856, 4141886572833888, 58405909554175776, 973789956270781056, 14462380128843907680, 273105193477731008160, 4136799937790535737280, 90747832174401786596160, 1330210995967208293223040, 35712038596571488594506240, 459971307758563315112678400, 16759025565623067167720922240, 153872898323554442977420913280, 9502553576041037302303131304320, 29331753836191371544252970983680, 6601765748922575270218876011045120, -34330952514996673312513889666926080, 5649694921952251824160234246760732160, -81970310394272708722608204653570880000, 5896042576665426099541035061340519070720, -137177062180389131579520127326036516211200, 7335414680544730378005554040572483603550720, -223409690922108539496595444423939170548075520, 10599273604447496604207276613266268867610741760, -380863622683887993719036283828582459876090009600, 17393181255018293224560363746907822698362373099520, -696682581645100925526612706405880968498080883015680, 31882326304453936376844891632291043117799396948162560, -1379684357010362363398329116560390535398311832198072320, 64535794192120375856888944800859176628984839355507845120, -2965308192518113268555807111153843805498625178929275187200, 143106479869443797738397877247738900070303587070400260034560, -6913669454039935734643297049724366202528629865516082084290560, 345625696270860704126702098297181511251440792521989009524285440, -17455310300784039087221138629444897160424620810741190954038353920, 905104861997091361764929457400832471576436843413792954382361559040, -47612047948489012911030458508571075045682281886777880897838765547520, 2560649188336942281067573832939177368287716363219304956709245017497600, -139954612302735255700349449253800846245117172374845840651106781122478080, 7801850577668418843292323453603002385487580906628232094303489623165255680, -442230323487695285162801433578439551067375088038318404828515689947928821760, 25528951764800900915287470159133769407295284557358622375066580742679695196160, -1498463622135984573644785030717743534873176446602995246809746355229678221393920, 89486922948584376778176179523754524152278084069321286902453649505935652820254720, -5432208100916142679284596346927610117271991913419269009353731199348187152436920320, 335249650442006846674789281239246343023451920605871006103432018955917970442174300160, -21022799734617433750338082884817233442879795926253036691399034893064902382217955573760, 1339437408078820187838337838245570777030048012638782052726600815527160833971392740392960, -86675240932139974180763268901914180520635849914745058900391047928537341250168880918036480, 5695699109930372872201349624445037317664836224164138794959825108269308745613818398448680960, -379969407406996158787347170381918015702392392970339059091557019964420359875226458395221032960, 25728948901675269248066199652277199868663629441658481676936761444286672502637247194928461905920, -1767904771782057131181972143897908734718155710465257700020764829982672658260600971985287774863360, 123246986926597303835350672886470011017118279973263630155000605965295940758133566101279325545431040, -8715224818029218006585477842403519058700527993914875493939280872649289198784063680614349296834969600, 625004429595490736525616327127430165693078093452752915813805627263173816885418703326078001773851443200, -45446700072054052907634101751118420990092723407720800683369835164989841538574918296511300158959845376000, 3350087483092226301447344012691859837532954083291208936365447537401263203429974971184740653385419771084800, -250301312024476467985099842878449825904198648549270467461122733612813603480493872378040596504466357852569600, 18951619777462135630831550542672067652387029532551350198641839646943620130098901691572735305558399088263168000, -1453882559978819165762982296605290000026252253955794617823515975276544260663334412424517716943166748192892518400, 112989649902170941149771081132383127554592296784172528053829977283088869679733043971756580132478092739494084608000, -8894101630368541666115639240884152544404791796265872624681712181101621264592856501651478565358506669336267351654400, 709005559043504264420998973256139915893676293533444806852305592594732620866770525815810125631019368063847605023539200, -57228556141283896897859955220660861104795953095172695765578292948844556282158618802250144146995694423871105102459699200, 4676542694232489686622214451443968584661215734191059072473864743338949149745149640310851259613006331546046864083910656000, -386830609709032807129393843222934471776152892627231754489690019053926536868628769849821436750391389046519569834523439923200, 32384491830928426777260463019519989712463499496883378675066396565830075025496684756692348538173221173864068790628333807206400, -2743542054029632216730659036625164175493010347845152993769434487145010930706740128385757456848138826428539833666834424869683200, 235171068853041113715942923274545204160925664726987696346232651538655742430590689424660404501173610958504324174133634212403609600, -20393639244089545979503936160250747194455812742453609737146580824207710821428693730702056054478190544869188210980401621193824665600, 1788901173435209230909624734022915858391646756134329641018939477304315507118227318285875537371642715140013331996959620362714742784000, -158709253484823208920068743240790692865765742713146042826062171221138739080815639693543439022699257333472784942935880932273186406400000, 14239253272376849705365379219144179785081383609578526375560466013748337333822777100298943440410029383669778622851939855602648388468736000, -1291776109288311153677581779809224484786821733872579413741288779443273865495723617037890398073304854764659147942298127393978908921141657600, 118481225857709656010755396750901597633965648101419006305344239273024198643321873817980031368577429005222358426406104766082134369067073536000, -10985565557856143161669841027539468269431571470058647241849781190899333920731336423273606636564048367804196546767773389977729952919758621900800, 1029568711460837224543256558493822827557930811317737446759709472423735201758851785719187183822862731604885754114203673086310296662242297171148800, -97521147501801177527722735256878066571526991732761607045173884799276811863802821987378473612002042048205530124833676042015307180415660766055628800, 9334786259269282531999390300359192365172917918550565993816376673988474214523708946966157981545482091030390703054636539003021686807464116232808038400, -902868760030213079042012904696969585743046166601919819351782865928197976386230896185537063595606610724480119091424894323839979613834071488719749120000, 88229351693092963864850735775624905731873402234078740473753648477020364912465675624362960552384140765660674574164986235589250160717225850406568145715200, -8710122250464274469459049185587361605140204685448098808496910418928997715997914538275134211897892315050756019914885702855431119492816398208187711566643200}
# A050971 Print[Table[4/(2 Pi)^n LerchPhi[(-1)^n, n, 1/2], {n, 200}] // Denominator]

