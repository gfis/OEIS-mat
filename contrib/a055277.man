# {T(n, k) = my(A = O(x)); if(k<1 || k>n, 0, for(j=1, n, A = x*(y - 1  + exp( sum(i=1, j, 1/i * subst( subst( A + x * O(x^(j\i)), x, x^i), y, y^i) ) ))); polcoeff( polcoeff(A, n), k))};
# Michael Somos
# for(n=1,100,write1("a055280.txt",",",T(n,5)))
#----
restart;
with(gfun):
# A002620:  
gf[2] := guessgf([1,2,4,6,9,12,16,20,25,30,36,42,49,56,64,72,81,90,100,110,121,132,144,156,169,182,196,210,225,240,256,272,289,306,324,342,361,380,400,420,441,462,484,506,529,552,576,600,625,650,676,702,729,756,784,812], x);
  # 2:{2,0,-2,1}
  #   [1/(-x^4+2*x^3-2*x+1), ogf]
den[2] := expand(-(x+1)*(x-1)^3);
#----------
  # 3:{3,-2,-1,0,1,2,-3,1}
  # A055278
gf[3] := guessgf([1,3,8,18,35,62,103,161,241,348,487,664,886,1159,1491,1890,2364,2922,3574,4329,5198,6192,7322,8600,10039,11651,13450,15450,17665,20110,22801,25753,28983,32508,36345,40512,45028,49911,55181,60858,66962,73514,80536], x);
  #   [-(x^3+x^2+1)/(x^8-3*x^7+2*x^6+x^5-x^3-2*x^2+3*x-1), ogf]
den[3] := expand((x^2+x+1)  *(x+1)^1*(x-1)^5);
  #   simplify(expand((x^2+x+1)  *(x+1)^1*(x-1)^5) / expand(-(x+1)*(x-1)^3));
  # ->  -x^4+x^3+x-1
#-----------
  #4:{3,-1,-4,3,-1,3,0,-3,1,-3,4,1,-3,1}
gf[4] := guessgf([1,4,14,39,97,212,429,804,1427,2406,3900,6094,9245,13645,19682,27791,38530,52516,70521,93390,122157,157945,202104,256090,321628,400567,495070,607445,740362,896657,1079581,1292574,1539546,1824621,2152452,2527932,2956546],x);
  # [(-x^8-2*x^7-5*x^6-5*x^5-7*x^4-5*x^3-3*x^2-x-1)/(x^2+1)/(x^2+x+1)/(1+x)^3/(x-1)^7, ogf]
  # den=x^7+4*x^6+8*x^5+11*x^4+11*x^3+8*x^2+4*x+1
  # 1,4,8,11,11,8,4,1
den[4] := expand((x^2+x+1)*(x^2+1)  *(1+x)^3*(x-1)^7);
  # x^4+x^3+2*x^2+x+1
  # simplify((x^2+x+1)*(x^2+1)  *(1+x)^3*(x-1)^7 / ((x^2+x+1)  *(x+1)^1*(x-1)^5));
  # -> (x^2+1)*(x+1)^2*(x-1)^2
#------------
# 5:{5,-8,0,15,-18,3,16,-19,0,19,-16,-3,18,-15,0,8,-5,1}
gf[5] := guessgf([1,5,21,72,214,563,1344,2958,6086,11820,21854,38713,66069,109109,175019,273540,417672,624472,916038,1320609,1873896,2620552,3615923,4927965,6639493,8850628,11681631,15275970,19803834,25465914,32497699,41174075,51814511,64788587,80522183,99504055,122293149,149526349,181927046,220314188,265612241,318861679,381230480,454026203,538709167,636906268,750425998,881274162,1031670902,1204068478,1401170469,1625951792,1881680258,2171939010,2500650617,2872102120,3290971856,3762357306,4291804849,4885340612,5549503361,6291378561,7118634617,8039560361,9063104861,10198918558,11457396870,12849725209,14387926615,16084910887,17954526489,20011614039,22272062735,24752868453,27472194946,30449436810,33705285718,37261798518,41142468772,45372300256,49977884081,54987477873,60431088759,66340558514,72749652700,79694152073,87211948172,95343141286,104130142798,113617780016,123853405584,134887009491,146771335867,159562002491,173317625295],x);
  # [-(x^11+2*x^10+4*x^9+10*x^8+9*x^7+13*x^6+12*x^5+7*x^4+7*x^3+4*x^2+1)/(x^18-5*x^17+8*x^16-15*x^14+18*x^13-3*x^12-16*x^11+19*x^10-19*x^8+16*x^7+3*x^6-18*x^5+15*x^4-8*x^2+5*x-1), ogf]
den[5] := expand((x^4+x^3+x^2+x+1)*(x^2+1)  *(1+x)^3*(x-1)^9);
  # simplify(expand((x^4+x^3+x^2+x+1)*(x^2+1)  *(1+x)^3*(x-1)^9) / expand((x^2+x+1)*(x^2+1)  *(1+x)^3*(x-1)^7));
  # -> (x^6-x^5-x+1)/(x^2+x+1)
#-----------
# 6:{3,0,-6,1,4,5,-6,-3,6,-5,-2,2,5,-1,0,1,-5,-2,2,5,-6,3,6,-5,-4,-1,6,0,-3,1}
gf[6] := guessgf([1,6,30,120,416,1268,3499,8833,20730,45625,95052,188638,358822,657169,1163791,1999495,3343038,5452829,8696613,13587910,20834487,31396728,46563312,68041054,98068941,139551650,196226198,272854810,375461896,511605805,690708240,924428664,1227113088,1616300216,2113321751,2743975123,3539313921,4536528202,5779970577,7322292667,9225759697,11563699697,14422168378,17901776114,22119774269,27212335208,33337141045,40676202614,49439043385,59866154407,72232878384,86853610855,104086502060,124338528336,148071144428,175806363163,208133506339,245716447429,289301625014,339726620389,397929616178,464959498162,541986960799,630316343117,731398602251,846845114149,978442758952,1128169938432,1298214040115,1490989948121,1709160176232,1955656173873,2233701445481,2546835978622,2898942694453,3294275354344,3737488713805,4233670293593,4788374641464,5407659383443,6098124029940,6866950757257,7721948226821,8671597581533],x);
  # [-(x^22+5*x^21+21*x^20+61*x^19+149*x^18+287*x^17+503*x^16+756*x^15+1028*x^14+1250*x^13+1397*x^12+1401*x^11+1303*x^10+1089*x^9+832*x^8+568*x^7+356*x^6+190*x^5+91*x^4+36*x^3+12*x^2+3*x+1)/(x^30-3*x^29+6*x^27-x^26-4*x^25-5*x^24+6*x^23+3*x^22-6*x^21+5*x^20+2*x^19-2*x^18-5*x^17+x^16-x^14+5*x^13+2*x^12-2*x^11-5*x^10+6*x^9-3*x^8-6*x^7+5*x^6+4*x^5+x^4-6*x^3+3*x-1), ogf]
den[6] := expand((x^2-x+1)*(x^4+x^3+x^2+x+1)*(x^2+1)*(x^2+x+1)^3*(x+1)^5*(x-1)^11);
  # simplify(expand((x^2-x+1)*(x^4+x^3+x^2+x+1)*(x^2+1)*(x^2+x+1)^3*(x+1)^5*(x-1)^11) / expand((x^4+x^3+x^2+x+1)*(x^2+1)  *(1+x)^3*(x-1)^9));
  # -> (x^2-x+1)*(x^2+x+1)^3  *(x-1)^2*(x+1)^2
#-----------
  # 7:{4,-3,-6,7,3,1,-10,-1,12,-5,-4,1,2,5,-2,-8,5,0,0,0,-5,8,2,-5,-2,-1,4,5,-12,1,10,-1,-3,-7,6,3,-4,1}
gf[7] := guessgf([1,7,40,185,732,2544,7949,22668,59773,147228,341653,752182,1580470,3185224,6183637,11606151,21127675,37405050,64561161,108866382,179684155,290762751,461978659,721658992,1109643254,1681275261,2512561363,3706772370,5402827325,7785852189,11100386299,15666780914,21901437438,30341624434,41675743801,56780032340,76762849577,103017847066,137287518775,181738810033,239052712995,312529993907,406215501492,525043768270,675008982867,863362725794,1098843298131,1391940846813,1755203007729,2203586229447,2754858549733,3430060114751,4254028443010,5255996040092,6470268797784,7936994310981,9703030202994,11822923356469,14360012047838,17387663909270,20990663901893,25266767541392,30328436053580,36304771339741,43343670261600,51614219118290,61309351030336,72648790482827,85882311356494,101293336503566,119202909256010,139974069191438,164016667089646,191792656177031,223821899666098,260688537007586,303047954509007,351634408651620,407269354027246,470870530782554,543461870430679,626184282166992,720307386208995,827242264293507,948555302289594,1085983203858456,1241449259393376,1417080958831478,1615229042739968,1838488090853479,2089718753595032,2372071737329196],x);
  # [-(-x^29-6*x^28-26*x^27-94*x^26-262*x^25-618*x^24-1248*x^23-2258*x^22-3674*x^21-5463*x^20-7482*x^19-9523*x^18-11281*x^17-12515*x^16-12994*x^15-12657*x^14-11551*x^13-9884*x^12-7889*x^11-5872*x^10-4040*x^9-2564*x^8-1484*x^7-777*x^6-359*x^5-147*x^4-52*x^3-15*x^2-3*x-1)/(-x^38+4*x^37-3*x^36-6*x^35+7*x^34+3*x^33+x^32-10*x^31-x^30+12*x^29-5*x^28-4*x^27+x^26+2*x^25+5*x^24-2*x^23-8*x^22+5*x^21-5*x^17+8*x^16+2*x^15-5*x^14-2*x^13-x^12+4*x^11+5*x^10-12*x^9+x^8+10*x^7-x^6-3*x^5-7*x^4+6*x^3+3*x^2-4*x+1), ogf]
den[7] := expand(-x^38+4*x^37-3*x^36-6*x^35+7*x^34+3*x^33+x^32-10*x^31-x^30+12*x^29-5*x^28-4*x^27+x^26+2*x^25+5*x^24-2*x^23-8*x^22+5*x^21-5*x^17+8*x^16+2*x^15-5*x^14-2*x^13-x^12+4*x^11+5*x^10-12*x^9+x^8+10*x^7-x^6-3*x^5-7*x^4+6*x^3+3*x^2-4*x+1);
  # -(x^2-x+1)*(x^4+x^3+x^2+x+1)*(x^6+x^5+x^4+x^3+x^2+x+1)  *(x^2+1)*(x^2+x+1)^3  *(x+1)^5*(x-1)^13
  # simplify((-(x^2-x+1)*(x^4+x^3+x^2+x+1)*(x^6+x^5+x^4+x^3+x^2+x+1)  *(x^2+1)*(x^2+x+1)^3  *(x+1)^5*(x-1)^13) / expand((x^2-x+1)*(x^4+x^3+x^2+x+1)*(x^2+1)*(x^2+x+1)^3*(x+1)^5*(x-1)^11));
  # -> -(x-1)^2*(x^6+x^5+x^4+x^3+x^2+x+1)
#-----------
  # 8: 
gf[8] := guessgf([1,8,52,270,1203,4682,16346,51901,151945,414116,1059945,2565394,5907070,13005279,27498902,56052155,110506991,211327231,393002091,712326630,1260881177,2183476067,3705027759,6169083918,10092371963,16240964556,25735496224,40194772913,61929949838,94204347453,141578213970,210362017880,309208036950,449876176496,648218771069,925437833261,1309680552685,1838050921819,2559132323195,3536132370534,4850784233196,6608160770584,8942588383041,12024876749044,16071120857759,21353370016751,28212510834495,37073760657620,48465235228017,63040117628395,81603041247055,105141379699279,134862244689823,172236093517440,219047983033316,277457632289205,350069623717191,440015227673430,551047541550188,687651824812678,855173163659154,1059963830729274,1309553011835582,1612841852309829,1980327145693111,2424357325318143,2959424863692242,3602499589017567,4373407958782705,5295263812001852,6394956752035034,7703704882694622,9257679365629117,11098708940220498,13275073424406457,15842396005453996,18864645157682821,22415257948703264,26578397695519238,31450360008768668,37141142658272093,43776195942712778,51498371862043042,60470091836093737,70875754577921991,82924407395329671,96852706339595812,112928192532620008,131452914464165468,152767428240176878,177255210576130528,205347521828490101,237528759563936348,274342346010698108,316397196381392995,364374818285922305,419037096585408996,481234821694148642,551917024009493350,632141181278437571,723084370980812274,826055444460622084,942508305468889669,1074056381009818363,1222488379042231194,1389785433451929757,1578139744172134119,1789974826891148975,2027967495128092231,2295071704785778013,2594544400596594017,2929973512044906713,3305308256712644434,3724891918080492422,4193497276334715559,4716364880817939498,5299244365539522002,5948439020342536250,6670853844474203566,7474047321678048654,8366287171569116731,9356610345718808767,10454887554141295186,11671892622943312759,13019377002924757550,14510149765510277497,16158163443324964047,17978606090969139922,19987999964544181562,22204307238506707637,24647043203656351796,27337397412014235528,30298363261985617073,33554876541230636587,37133963474900565032,41064898853167447785,45379374845005945386,50111681133868076715,55298897046932374193,60981096380883994927,67201565666458218226,74007036648040432881,81447933797365156644,89578637717406715515,98457765339029534983,108148467853221022840,118718747372198022107],x);
  # [-(x^38+6*x^37+35*x^36+132*x^35+445*x^34+1183*x^33+2839*x^32+5918*x^31+11346*x^30+19710*x^29+32008*x^28+48217*x^27+68629*x^26+91820*x^25+116915*x^24+141020*x^23+162544*x^22+178250*x^21+187211*x^20+187419*x^19+179792*x^18+164349*x^17+143821*x^16+119655*x^15+95046*x^14+71433*x^13+51020*x^12+34197*x^11+21630*x^10+12669*x^9+6932*x^8+3440*x^7+1576*x^6+629*x^5+230*x^4+70*x^3+19*x^2+3*x+1)/(x^48-5*x^47+7*x^46+4*x^45-19*x^44+16*x^43-x^42-11*x^41+19*x^40-13*x^39-3*x^38+4*x^37+5*x^36-11*x^34+5*x^33+7*x^32-6*x^31-2*x^30+12*x^29-16*x^28+4*x^27+14*x^26-18*x^25+18*x^23-14*x^22-4*x^21+16*x^20-12*x^19+2*x^18+6*x^17-7*x^16-5*x^15+11*x^14-5*x^12-4*x^11+3*x^10+13*x^9-19*x^8+11*x^7+x^6-16*x^5+19*x^4-4*x^3-7*x^2+5*x-1), ogf]
den[8] := expand(x^48-5*x^47+7*x^46+4*x^45-19*x^44+16*x^43-x^42-11*x^41+19*x^40-13*x^39-3*x^38+4*x^37+5*x^36-11*x^34+5*x^33+7*x^32-6*x^31-2*x^30+12*x^29-16*x^28+4*x^27+14*x^26-18*x^25+18*x^23-14*x^22-4*x^21+16*x^20-12*x^19+2*x^18+6*x^17-7*x^16-5*x^15+11*x^14-5*x^12-4*x^11+3*x^10+13*x^9-19*x^8+11*x^7+x^6-16*x^5+19*x^4-4*x^3-7*x^2+5*x-1);
  # simplify(   (x^48-5*x^47+7*x^46+4*x^45-19*x^44+16*x^43-x^42-11*x^41+19*x^40-13*x^39-3*x^38+4*x^37+5*x^36-11*x^34+5*x^33+7*x^32-6*x^31-2*x^30+12*x^29-16*x^28+4*x^27+14*x^26-18*x^25+18*x^23-14*x^22-4*x^21+16*x^20-12*x^19+2*x^18+6*x^17-7*x^16-5*x^15+11*x^14-5*x^12-4*x^11+3*x^10+13*x^9-19*x^8+11*x^7+x^6-16*x^5+19*x^4-4*x^3-7*x^2+5*x-1));
  # (x^2-x+1)*(x^4+x^3+x^2+x+1)*(x^4+1)*(x^6+x^5+x^4+x^3+x^2+x+1)*(x^2+x+1)^2*(x^2+1)^3  *(x+1)^7*(x-1)^15
#-----------
  # 9:
gf[9] := guessgf([1,9,65,378,1867,8056,31061,108692,349703,1044990,2924863,7722047,19346165,46229029,105831924,233008811,495046641,1017948120,2031186319,3942115307,7457028087,13774178034,24885909121,44043512380,76461184435,130366379373,218545555182,360589766314,586117844494,939350542991,1485533159666,2319863507210,3579785709504,5461767886033,8244006332560,12316904105750,18223676211250,26714056110183,38814844165942,55921974251645,79919914237593,113335594915652,159535725829436,222978352606885,309531899099308,426877780723811,585016051664327,796897538135862,1079210614291563,1453356299419835,1946651824405007,2593810362601984,3438753409206931,4536822488227126,5957468672579701,7787512025898095,10135078769462288,13134341998294289,16951212431801423,21790149298563451,27902288407572554,35595115130714737,45243944882696486,57305513197291941,72334022230306532,91000041027367637,114112713860781434,142645795032730719,177768100577661576,220879048071828452,273650046243199462,338072597215877768,416514087168539574,511782367053277207,627200365163023595,766692129065580503,934881867328391027,1137207753077760715,1380052463624500066,1670892664937844311,2018469908819895752,2432985696305916197,2926323775595291481,3512303089113440349,4206965165008498811,5028900166277989749,5999616269129657612,7143957544302021126,8490576064726363796,10072464563763407062,11927556624667625740,14099402098102968118,16637926225443694407,19600281796007389148,23051804591959240654,27067083380809105815,31731156808633502402,37140850733526071202,43406270825596382274,50652466654027847533,59021284991494150511,68673431699431539512,79790763323530183766,92578831436128792257,107269704821373712238,124125096819896496358,143439827544033125048,165545653253293274836,190815497955931360321,219668125288410108399,252573291934839943109,290057427296880397087,332709887827323697403,381189838412955908445,436233817452342515918,498664046838923719213,569397552949245892041,649456169969160976057,739977502489573794538,842226930288685779909,957610744614200859757,1087690512109699356961,1234198769821431313552,1399056162500586790774,1584390141711526689594,1792555355096541604726,2026155863565311846386,2288069334203210098447,2581473367363035807323,2909874127753564921973,3277137461405079163145,3687522693213944029145,4145719313388771027469,4656886775580401723160,5226697644824422804052,5861384349702642106311,6567789810390879873695,7353422232553135071754,8226514376423378043919,9196087630938891130588,10272021244515040460696,11465127087038344053642,12787230341970009561702,14251256553158563198637,15871325478130970664711,17662852228335036260538,19642656207121357725706,21829078388254827885750,24242107511519874956874,26903515807610690454587,29837004902071099292885,33068362587655546734647,36625631196224129587138,40539288345254893812458,44842440880365237876974,49571032883983036642442,54764068671615318454828,60463851751137970639545,66716240777301687105098,73570923593335856918359,81081710514271008842941],x);
#-----------
opden := proc(x): denom(op(1,x)); end:
seq(printf("%a: %a\n",n,opden(gf[n])), n=2..9);
dquot := proc(n, x) local dn, dd, ds: 
  dn := opden(gf[n]): 
  dd := opden(gf[n-2]): 
  ds := simplify(dn / dd /(x+1)^2 /(x-1)^4) * (x^2+x+1): 
  printf("%a: %a\n"  , n, simplify(dn / dd)) :
  printf("%a: %a\n\n", n, expand(ds)) :
  end:
seq(dquot(n,x), n=4..9);

seq(printf("%a: %a\n",n,simplify(den[n]/den[n-2])), n=4..8);
  # 4: -x^10+x^9+x^8-2*x^5+x^2+x-1
  # 5: (x^2+1)*(x^4+x^3+x^2+x+1)/(x^2+x+1)  *(x+1)^2*(x-1)^4
  # 6: x^16-x^14-x^13-x^10+x^9+2*x^8+x^7-x^6-x^3-x^2+1
  # 7: -(x^2-x+1)*(x^6+x^5+x^4+x^3+x^2+x+1)*(x^2+x+1)^3   *(x+1)^2*(x-1)^4
  # 8: (x^20-x^19-x^16+x^15-x^13+x^11+x^9-x^7+x^5-x^4-x+1)/(x^2+x+1)