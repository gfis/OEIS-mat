# Expand A196411
# 2021-05-12, Georg Fischer: 
#
#:# Usage:
#:#   perl binomin_patch.pl [-d debug] binomin2.tmp > binomin3.tmp
#:#     -d  debugging level (0=none (default), 1=some, 2=more)
#--------------------------------------------------------
use strict;
use integer;
use warnings;

my $line = "";
my ($aseqno, $callcode, $offset, @parms);
my $debug   = 0;
while (scalar(@ARGV) > 0 and ($ARGV[0] =~ m{\A[\-\+]})) {
    my $opt = shift(@ARGV);
    if (0) {
    } elsif ($opt   =~ m{\-d}  ) {
        $debug      = shift(@ARGV);
    } else {
        die "invalid option \"$opt\"\n";
    }
} # while $opt

while (<>) { # seq4 format
    next if ! m{\AA\d\d+}; # no aseqno
    s/\s+\Z//; # chompr
    $line = $_;
    ($aseqno, $callcode, @parms) = split(/\t/, $line);
    $offset = $parms[0];
    $parms[4] = "";
    $parms[2] = "[" . join(",", splice(@terms, 0, $ind + 2)) . "]";
    print join("\t", $aseqno, $callcode, @parms) . "\n"; 
} # while <>
__DATA__
a(n) = n! - n^k
a(n) + n^k = n*(n-1)!
(a(n) + n^k)/n = (n-1)!
a(n-1) + (n-1)^k = (n-1)!
a(n) + n^k = n*a(n-1) + n*(n-1)^k
0 = - a(n) + n*a(n-1) + n*(n-1)^k - n^k 

seq([seq(coeff(n*(n-1)^k - n^k,n,j),j=0..k+1)],k=2..10);
[[0,1,-3,1],[0,1],[-1]]	[1]
[[0,-1,3,-4,1],[0,1],[-1]]	[1]
[[0,1,-4,6,-5,1],[0,1],[-1]]	[1]
[[0,-1,5,-10,10,-6,1],[0,1],[-1]]	[1]
[[0,1,-6,15,-20,15,-7,1],[0,1],[-1]]	[1]
[[0,-1,7,-21,35,-35,21,-8,1],[0,1],[-1]]	[1]
[[0,1,-8,28,-56,70,-56,28,-9,1],[0,1],[-1]]	[1]
[[0,-1,9,-36,84,-126,126,-84,36,-10,1],[0,1],[-1]]	[1]
[[0,1,-10,45,-120,210,-252,210,-120,45,-11,1],[0,1],[-1]]	[1]

# A196411		n! - n^4		6
1, 0, -14, -75, -232, -505, -576, 2639, 36224, 356319
make runholo MATRIX="[[0,1,-4,6,-5,1],[0,1],[-1]]" INIT="[1]"
make runholo MATRIX="[[0,-2,1],[0,1],[-1]]" INIT="[1,0,0,3]"

A005096	holos	0	[[0,-2,1],[0,1],[-1]]	[1]	0		n!-n^1	N								
A005008	holos	0	[[0,1,-3,1],[0,1],[-1]]	[1]	0		n!-n^2	N								
A007339	holos	0	[[0,-1,3,-4,1],[0,1],[-1]]	[1]	0		n!-n^3	N								
A196411	holos	0	[[0,1,-4,6,-5,1],[0,1],[-1]]	[1]	0		n!-n^4	o								
A196412	holos	0	[[0,-1,5,-10,10,-6,1],[0,1],[-1]]	[1]	0		n!-n^5	t								
A196413	holos	0	[[0,1,-6,15,-20,15,-7,1],[0,1],[-1]]	[1]	0		n!-n^6	t								
A196414	holos	0	[[0,-1,7,-21,35,-35,21,-8,1],[0,1],[-1]]	[1]	0		n!-n^7	o								
A196738	holos	0	[[0,1,-8,28,-56,70,-56,28,-9,1],[0,1],[-1]]	[1]	0		n!-n^8	o								
A144768	holos	0	[[0,-1,9,-36,84,-126,126,-84,36,-10,1],[0,1],[-1]]	[1]	0		n!-n^9	N								
A196739	holos	0	[[0,1,-10,45,-120,210,-252,210,-120,45,-11,1],[0,1],[-1]]	[1]	0		n!-n^10	N								
# A200011	holos	0	[[0,-1,11,-55,165,-330,462,-462,330,-165,55,-12,1],[0,1],[-1]]	[1]	0		n!-n^11	N								
# A200012	holos	0	[[0,1,-12,66,-220,495,-792,924,-792,495,-220,66-13,1],[0,1],[-1]]	[1]	0		n!-n^12	N								
